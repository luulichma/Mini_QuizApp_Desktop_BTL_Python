#:kivy 2.1.0
#:import Factory kivy.factory.Factory

<HistoryListItem@BoxLayout>:
    size_hint_y: None
    height: dp(80)
    padding: [20, 15]
    spacing: 20
    background_color: 1, 1, 1, 1

    Label:
        id: history_quiz_title
        text: "Quiz Title"
        font_size: "18sp"
        color: 0.1, 0.1, 0.1, 1

    Label:
        id: history_quiz_score
        text: "Score: 0/0"
        size_hint_x: 0.3
        font_size: "18sp"
        bold: True
        color: 0.2, 0.5, 1, 1

<StudentHomeScreen>:
    name: "student_home"

    BoxLayout:
        orientation: "vertical"
        canvas.before:
            Color:
                rgba: 0.95, 0.95, 0.95, 1
            Rectangle:
                size: self.size
                pos: self.pos

        # Top bar
        BoxLayout:
            size_hint_y: None
            height: dp(70)
            padding: [dp(30), dp(15)]
            background_color: 0.9, 0.1, 0.1, 1

            Label:
                text: "Quiz App"
                font_size: "28sp"
                bold: True
                color: 1, 1, 1, 1

            Button:
                text: "Đăng xuất"
                size_hint_x: 0.2
                font_size: "18sp"
                background_color: 1, 1, 1, 0.2
                color: 1, 1, 1, 1
                on_release: root.logout()

        # TabbedPanel
        TabbedPanel:
            id: content_tabs
            do_default_tab: True
            tab_pos: 'top_mid'
            tab_width: dp(180)
            background_color: 0.95, 0.95, 0.95, 1

            # --- Take Quiz Tab ---
            TabbedPanelItem:
                id: home_tab_item
                text: "Làm Quiz"
                BoxLayout:
                    orientation: "vertical"
                    padding: dp(50)
                    spacing: dp(25)

                    Label:
                        text: "Nhập ID Quiz để bắt đầu"
                        font_size: "24sp"
                        color: 0.1, 0.1, 0.1, 1

                    TextInput:
                        id: quiz_id_input
                        hint_text: "ID Quiz"
                        font_size: "20sp"
                        multiline: False
                        size_hint_y: None
                        height: dp(60)
                        padding: [20, 20, 20, 20]

                    Button:
                        text: "Bắt đầu"
                        size_hint_y: None
                        height: dp(60)
                        font_size: "22sp"
                        bold: True
                        background_color: 0.2, 0.5, 1, 1
                        color: 1, 1, 1, 1
                        on_release: root.start_quiz_by_id()

            # --- History Tab ---
            TabbedPanelItem:
                text: "Lịch sử"
                on_release: root.load_history()
                ScrollView:
                    BoxLayout:
                        id: history_list
                        orientation: 'vertical'
                        size_hint_y: None
                        height: self.minimum_height
                        spacing: dp(15)
                        padding: [dp(20), dp(20)]

            # --- Account Tab ---
            TabbedPanelItem:
                text: "Tài khoản"
                BoxLayout:
                    orientation: "vertical"
                    padding: dp(50)
                    spacing: dp(25)

                    Button:
                        text: "Đổi mật khẩu"
                        size_hint_y: None
                        height: dp(60)
                        font_size: "20sp"
                        on_release: root.go_to_change_password()
