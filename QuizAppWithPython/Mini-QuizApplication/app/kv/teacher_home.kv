#:kivy 2.1.0
#:import Factory kivy.factory.Factory

<TeacherHomeScreen>:
    name: "teacher_home"

    BoxLayout:
        orientation: "vertical"
        canvas.before:
            Color:
                rgba: 0.93, 0.96, 1, 1
            Rectangle:
                size: self.size
                pos: self.pos

        # Top bar
        BoxLayout:
            size_hint_y: None
            height: dp(65)
            padding: [dp(25), dp(10)]
            spacing: dp(15)
            canvas.before:
                Color:
                    rgba: 0.25, 0.55, 0.95, 1
                Rectangle:
                    pos: self.pos
                    size: self.size

            Label:
                text: "Quiz App - Giảng viên"
                font_size: "24sp"
                bold: True
                color: 1, 1, 1, 1
                halign: "left"
                valign: "middle"


            Button:
                text: "Đăng xuất"
                font_size: "18sp"
                bold: True
                background_normal: ""
                background_down: ""
                background_color: 0, 0, 0, 0
                color: 1, 1, 1, 1
                size_hint_x: None
                width: dp(130)
                height: dp(40)
                on_release: root.logout()
                canvas.before:
                    Color:
                        rgba: 0, 0, 0, 0.15
                    RoundedRectangle:
                        pos: self.x, self.y - dp(2)
                        size: self.width, self.height
                        radius: [self.height / 2]
                    Color:
                        rgba: 0.9, 0.2, 0.2, 1
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [self.height / 2]


        # TabbedPanel
        TabbedPanel:
            id: content_tabs
            do_default_tab: True
            tab_pos: 'top_mid'
            tab_width: dp(180)
            background_color: 0.93, 0.96, 1, 1

            # --- Home Tab ---
            TabbedPanelItem:
                id: home_tab_item
                text: "Trang chủ"
                BoxLayout:
                    orientation: "vertical"
                    padding: dp(50)
                    spacing: dp(25)

                    Label:
                        text: "Chào mừng, Giảng viên!"
                        font_size: "32sp"
                        bold: True
                        color: 1, 1, 1, 1

                    Button:
                        text: "Tạo Quiz mới"
                        size_hint_y: None
                        height: dp(60)
                        font_size: "22sp"
                        bold: True
                        background_normal: ""
                        background_color: 0, 0, 0, 0
                        color: 1, 1, 1, 1
                        on_release: root.go_to_create_quiz()
                        canvas.before:
                            Color:
                                rgba: 0.25, 0.55, 0.95, 1
                            RoundedRectangle:
                                pos: self.pos
                                size: self.size
                                radius: [self.height / 2]

            # --- Library Tab ---
            TabbedPanelItem:
                text: "Thư viện Quiz"
                on_release: root.load_quiz_library()
                ScrollView:
                    GridLayout:
                        id: quiz_list
                        cols: 1
                        size_hint_y: None
                        height: self.minimum_height
                        spacing: dp(15)
                        padding: [dp(20), dp(20)]

            # --- Classes Tab ---
            TabbedPanelItem:
                text: "Lớp học"
                on_release: root.load_classes()
                ScrollView:
                    BoxLayout:
                        id: class_list
                        orientation: 'vertical'
                        size_hint_y: None
                        height: self.minimum_height
                        spacing: dp(15)
                        padding: [dp(20), dp(20)]

            # --- Account Tab ---
            TabbedPanelItem:
                text: "Tài khoản"
                BoxLayout:
                    orientation: "vertical"
                    padding: dp(40)
                    spacing: dp(25)
                    pos_hint: {"center_x": 0.5, "center_y": 0.5}

                    BoxLayout:
                        orientation: "vertical"
                        size_hint: (0.75, None)
                        height: dp(320)
                        pos_hint: {"center_x": 0.5}
                        padding: dp(25)
                        spacing: dp(18)
                        canvas.before:
                            Color:
                                rgba: 1, 1, 1, 1
                            RoundedRectangle:
                                pos: self.pos
                                size: self.size
                                radius: [25]
                            Color:
                                rgba: 0, 0, 0, 0.08
                            Line:
                                width: 1.2
                                rounded_rectangle: [self.x, self.y, self.width, self.height, 25]

                        Label:
                            text: "Đổi mật khẩu"
                            font_size: "22sp"
                            bold: True
                            color: 0.1, 0.1, 0.1, 1
                            size_hint_y: None
                            height: dp(30)

                        # --- Các ô nhập bo tròn ---
                        BoxLayout:
                            size_hint_y: None
                            height: dp(45)
                            canvas.before:
                                Color:
                                    rgba: 0.96, 0.96, 0.96, 1
                                RoundedRectangle:
                                    pos: self.pos
                                    size: self.size
                                    radius: [22.5]
                            TextInput:
                                hint_text: "Mật khẩu cũ"
                                multiline: False
                                password: True
                                background_color: 0, 0, 0, 0
                                padding: [15, 12, 15, 12]
                                font_size: "16sp"

                        BoxLayout:
                            size_hint_y: None
                            height: dp(45)
                            canvas.before:
                                Color:
                                    rgba: 0.96, 0.96, 0.96, 1
                                RoundedRectangle:
                                    pos: self.pos
                                    size: self.size
                                    radius: [22.5]
                            TextInput:
                                hint_text: "Mật khẩu mới"
                                multiline: False
                                password: True
                                background_color: 0, 0, 0, 0
                                padding: [15, 12, 15, 12]
                                font_size: "16sp"

                        BoxLayout:
                            size_hint_y: None
                            height: dp(45)
                            canvas.before:
                                Color:
                                    rgba: 0.96, 0.96, 0.96, 1
                                RoundedRectangle:
                                    pos: self.pos
                                    size: self.size
                                    radius: [22.5]
                            TextInput:
                                hint_text: "Nhập lại mật khẩu mới"
                                multiline: False
                                password: True
                                background_color: 0, 0, 0, 0
                                padding: [15, 12, 15, 12]
                                font_size: "16sp"

                        # --- Hai nút Lưu / Hủy ---
                        BoxLayout:
                            size_hint_y: None
                            height: dp(50)
                            spacing: dp(20)
                            pos_hint: {"center_x": 0.5}

                            Button:
                                text: "Lưu"
                                font_size: "17sp"
                                bold: True
                                background_normal: ""
                                background_color: 0, 0, 0, 0
                                color: 1, 1, 1, 1
                                on_release: root.go_to_change_password()
                                canvas.before:
                                    Color:
                                        rgba: 0.25, 0.55, 0.95, 1
                                    RoundedRectangle:
                                        pos: self.pos
                                        size: self.size
                                        radius: [self.height / 2]

                            Button:
                                text: "Hủy"
                                font_size: "17sp"
                                bold: True
                                background_normal: ""
                                background_color: 0, 0, 0, 0
                                color: 0.25, 0.55, 0.95, 1
                                canvas.before:
                                    Color:
                                        rgba: 1, 1, 1, 1
                                    RoundedRectangle:
                                        pos: self.pos
                                        size: self.size
                                        radius: [self.height / 2]
                                    Color:
                                        rgba: 0.25, 0.55, 0.95, 1
                                    Line:
                                        width: 1.5
                                        rounded_rectangle: [self.x, self.y, self.width, self.height, self.height / 2]