<ChangePasswordScreen>:
    name: 'change_password'

    BoxLayout:
        orientation: 'vertical'
        padding: dp(30), dp(100), dp(30), dp(30)
        spacing: dp(20)
        canvas.before:
            Color:
                rgba: 1, 1, 1, 1  # nền trắng tinh
            Rectangle:
                pos: self.pos
                size: self.size

        # --- Tiêu đề ---
        Label:
            text: "Đổi mật khẩu"
            font_size: "26sp"
            bold: True
            color: 0.15, 0.15, 0.15, 1
            halign: "center"
            valign: "middle"
            text_size: self.size
            size_hint_y: None
            height: dp(50)

        # --- Mật khẩu cũ ---
        BoxLayout:
            size_hint_y: None
            height: dp(50)
            canvas.before:
                Color:
                    rgba: 0.96, 0.96, 0.96, 1  # nền xám nhạt
                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius: [10]
            TextInput:
                id: old_password
                hint_text: "Mật khẩu cũ"
                password: True
                background_normal: ""
                background_active: ""
                background_color: 0, 0, 0, 0
                foreground_color: 0.1, 0.1, 0.1, 1
                padding: [15, 15, 15, 15]
                cursor_color: 0.25, 0.5, 1, 1
                font_size: "16sp"

        # --- Mật khẩu mới ---
        BoxLayout:
            size_hint_y: None
            height: dp(50)
            canvas.before:
                Color:
                    rgba: 0.96, 0.96, 0.96, 1
                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius: [10]
            TextInput:
                id: new_password
                hint_text: "Mật khẩu mới"
                password: True
                background_normal: ""
                background_active: ""
                background_color: 0, 0, 0, 0
                foreground_color: 0.1, 0.1, 0.1, 1
                padding: [15, 15, 15, 15]
                cursor_color: 0.25, 0.5, 1, 1
                font_size: "16sp"

        # --- Xác nhận mật khẩu mới ---
        BoxLayout:
            size_hint_y: None
            height: dp(50)
            canvas.before:
                Color:
                    rgba: 0.96, 0.96, 0.96, 1
                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius: [10]
            TextInput:
                id: confirm_new_password
                hint_text: "Xác nhận mật khẩu mới"
                password: True
                background_normal: ""
                background_active: ""
                background_color: 0, 0, 0, 0
                foreground_color: 0.1, 0.1, 0.1, 1
                padding: [15, 15, 15, 15]
                cursor_color: 0.25, 0.5, 1, 1
                font_size: "16sp"

        # --- Label trạng thái ---
        Label:
            id: status_label
            text: ""
            color: 0.7, 0.1, 0.1, 1
            font_size: "14sp"
            halign: "center"
            valign: "middle"
            text_size: self.size
            size_hint_y: None
            height: dp(40)

        # --- Nút hành động ---
        BoxLayout:
            size_hint_y: None
            height: dp(60)
            spacing: dp(20)

            # Nút Hủy
            Button:
                text: 'Hủy'
                font_size: "16sp"
                background_normal: ""
                background_color: 1, 1, 1, 1
                color: 0.3, 0.3, 0.3, 1
                canvas.before:
                    Color:
                        rgba: 0.85, 0.85, 0.85, 1
                    Line:
                        width: 1.2
                        rounded_rectangle: [self.x, self.y, self.width, self.height, 12]
                on_release: root.go_back()

            # Nút Lưu thay đổi
            Button:
                id: save_button
                text: 'Lưu thay đổi'
                font_size: "16sp"
                bold: True
                background_normal: ""
                background_color: 0.23, 0.51, 0.96, 1  # xanh pastel
                color: 1, 1, 1, 1
                canvas.before:
                    Color:
                        rgba: self.background_color
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [12]
                on_release: root.save_password()
